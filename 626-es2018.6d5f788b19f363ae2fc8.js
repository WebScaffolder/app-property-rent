"use strict";(self.webpackChunkmaterial_dashboard_angular=self.webpackChunkmaterial_dashboard_angular||[]).push([[626],{48878:function(t,e,i){i.r(e),i.d(e,{UserRolesSettingModule:function(){return at}});var o=i(39895),a=i(22238),s=i(99692),r=i(11494),n=i(28292),l=i(22759),c=i(66682),m=i(54395),u=i(87519),d=i(68307),h=i(1581);class f extends h.y{constructor(t){super(t)}}var g=i(3679),p=i(37716),Z=i(69180),b=i(57404),v=i(98295),x=i(49983),A=i(38583),q=i(51095),_=i(12178);function T(t,e){if(1&t&&(p.TgZ(0,"mat-error",12),p._uU(1),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Oqu(t.formErrors.name)}}function N(t,e){if(1&t&&(p.TgZ(0,"mat-error",12),p._uU(1),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Oqu(t.formErrors.display_name)}}function w(t,e){1&t&&(p.TgZ(0,"div",13),p._UZ(1,"mat-progress-bar",14),p.qZA())}let S=(()=>{class t{constructor(t,e,i,o,a){this.fb=e,this.roleService=i,this.notification=o,this.dialogRef=a,this.loader=!1}ngOnInit(){this.form=this.fb.group({name:["",[g.kI.required,g.kI.minLength(3)]],display_name:[""]})}save(){this.dialogRef.close(this.form.value)}close(){this.dialogRef.close()}create(){const t=Object.assign({},this.role,this.form.value);this.loader=!0,this.roleService.create(t).subscribe(t=>{this.onSaveComplete(),this.notification.showNotification("success","Success !! New role created.")},t=>{if(this.loader=!1,0!==t.role){if(this.formErrors=t,this.formErrors)for(const t in this.formErrors)this.form&&this.form.controls[t].setErrors({incorrect:!0})}else this.notification.showNotification("danger","Connection Error !! Nothing created. Check your connection and retry.")})}onSaveComplete(){this.loader=!1,this.form.reset(),this.dialogRef.close(this.form.value)}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(a.WI),p.Y36(g.qu),p.Y36(Z.k),p.Y36(b.g),p.Y36(a.so))},t.\u0275cmp=p.Xpm({type:t,selectors:[["robi-add-role"]],decls:22,vars:8,consts:[["mat-dialog-title",""],[1,"mat-dialog-data",3,"formGroup","ngSubmit"],["color","primary","appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Name"],["align","start","class","form__error",4,"ngIf"],["formControlName","display_name","matInput","","placeholder","Display Name","maxlength","150","rows","5"],["display_name",""],["align","end"],["class","d-flex justify-content-center spinner-container",4,"ngIf"],["align","center"],["mat-button","","color","accent",1,"mr-2",3,"disabled","mat-dialog-close","click"],["mat-raised-button","","color","primary",3,"disabled","click"],["align","start",1,"form__error"],[1,"d-flex","justify-content-center","spinner-container"],["color","green","mode","query","value","50","bufferValue","75"]],template:function(t,e){if(1&t&&(p.TgZ(0,"h5",0),p._uU(1,"Add Role"),p.qZA(),p.TgZ(2,"mat-dialog-content",1),p.NdJ("ngSubmit",function(){return e.create()}),p.TgZ(3,"mat-form-field",2),p.TgZ(4,"mat-label"),p._uU(5,"Name"),p.qZA(),p._UZ(6,"input",3),p.YNc(7,T,2,1,"mat-error",4),p.qZA(),p.TgZ(8,"mat-form-field",2),p.TgZ(9,"mat-label"),p._uU(10,"Display Name"),p.qZA(),p._UZ(11,"textarea",5,6),p.TgZ(13,"mat-hint",7),p._uU(14),p.qZA(),p.YNc(15,N,2,1,"mat-error",4),p.qZA(),p.qZA(),p.YNc(16,w,2,0,"div",8),p.TgZ(17,"mat-dialog-actions",9),p.TgZ(18,"button",10),p.NdJ("click",function(){return e.close()}),p._uU(19,"Cancel"),p.qZA(),p.TgZ(20,"button",11),p.NdJ("click",function(){return e.create()}),p._uU(21,"Save"),p.qZA(),p.qZA()),2&t){const t=p.MAs(12);p.xp6(2),p.Q6J("formGroup",e.form),p.xp6(5),p.Q6J("ngIf",null==e.formErrors?null:e.formErrors.name),p.xp6(7),p.hij("",t.value.length," / 150"),p.xp6(1),p.Q6J("ngIf",null==e.formErrors?null:e.formErrors.display_name),p.xp6(1),p.Q6J("ngIf",e.loader),p.xp6(2),p.Q6J("disabled",e.loader)("mat-dialog-close",!0),p.xp6(2),p.Q6J("disabled",!e.form.valid||e.loader)}},directives:[a.uh,a.xY,g.JL,g.sg,v.KE,v.hX,x.Nt,g.Fj,g.JJ,g.u,A.O5,g.nD,v.bx,a.H8,q.lW,a.ZT,v.TO,_.pW],encapsulation:2}),t})();var y=i(2603),C=i(86710),U=i(76627),J=i(7539);function E(t,e){if(1&t&&(p.TgZ(0,"mat-error",15),p._uU(1),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Oqu(t.formErrors.name)}}function Y(t,e){if(1&t&&(p.TgZ(0,"mat-error",15),p._uU(1),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Oqu(t.formErrors.display_name)}}function I(t,e){if(1&t&&(p.TgZ(0,"mat-error",15),p._uU(1),p.qZA()),2&t){const t=p.oxw();p.xp6(1),p.Oqu(t.formErrors.permissions)}}function k(t,e){if(1&t&&(p.TgZ(0,"div",16),p.TgZ(1,"mat-checkbox",17),p._uU(2),p.qZA(),p.qZA()),2&t){const t=e.index,i=p.oxw();p.xp6(1),p.Q6J("formControlName",t),p.xp6(1),p.hij(" ",i.options[t].label," ")}}function D(t,e){1&t&&(p.TgZ(0,"div",18),p._UZ(1,"mat-progress-bar",19),p.qZA())}let j=(()=>{class t{constructor(t,e,i,o,a,s,r,n){this.store=e,this.fb=i,this.dialog=o,this.roleService=a,this.notification=s,this.router=r,this.dialogRef=n,this.options=Array(),this.loader=!1,this.toggle=new p.vpe,this.role=t.role,this.options=t.permOptions,this.selectedValues=this.role.permissions.map(t=>t.id),this.editForm=this.fb.group({name:[this.role.name,[g.kI.required,g.kI.minLength(3)]],display_name:[this.role.display_name],permissions:new g.Oe([])})}get items(){return this.editForm.get("permissions")}ngOnInit(){this.editForm.valueChanges.subscribe(t=>{const e=new Array;for(let i=0;i<this.items.length;i++)this.items.get(i.toString()).value&&e.push(this.options[i].value);this.toggle.emit(e)}),0===this.items.length&&this.options.forEach(t=>{this.items.push(new g.NI(!1))}),this.selectedValues.forEach(t=>{const e=this.options.findIndex(e=>e.value===t);e>=0&&this.items.get(e.toString()).setValue(!0)})}close(){this.dialogRef.close()}selectedPermissions(){return this.editForm.value.permissions.map((t,e)=>t?this.options[e].value:null).filter(t=>null!==t)}update(){const t=Object.assign({},this.role,this.editForm.value);this.finalPermissions=this.selectedPermissions(),t.permissions=this.finalPermissions,this.loader=!0,this.roleService.update(t).subscribe(t=>{this.loader=!1,this.dialogRef.close(this.editForm.value),this.notification.showNotification("success","Success !! Role has been updated."),this.store.dispatch(y.u.actionLogout())},t=>{if(this.loader=!1,this.formErrors=t,this.formErrors)for(const e in this.formErrors)this.editForm&&this.editForm.controls[e].setErrors({incorrect:!0})})}deleting(){this.dialogRef.close("deleting")}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(a.WI),p.Y36(C.yh),p.Y36(g.qu),p.Y36(a.uw),p.Y36(Z.k),p.Y36(b.g),p.Y36(o.F0),p.Y36(a.so))},t.\u0275cmp=p.Xpm({type:t,selectors:[["robi-edit-role"]],outputs:{toggle:"toggle"},decls:30,vars:10,consts:[["mat-dialog-title",""],[1,"mat-dialog-data",3,"formGroup","ngSubmit"],[1,"row"],[1,"col-lg-12"],["color","primary","appearance","outline",1,"full-width"],["matInput","","formControlName","name","placeholder","Name"],["align","start","class","form__error",4,"ngIf"],["matInput","","formControlName","display_name","placeholder","Display Name"],["formArrayName","permissions",1,"row","col-lg-12"],["class","col-6",4,"ngFor","ngForOf"],["class","d-flex justify-content-center spinner-container",4,"ngIf"],["align","center"],["mat-button","","color","warn",1,"mr-2",3,"disabled","click"],["mat-button","","color","accent",1,"mr-2",3,"disabled","mat-dialog-close","click"],["mat-raised-button","","color","primary",3,"disabled","click"],["align","start",1,"form__error"],[1,"col-6"],[3,"formControlName"],[1,"d-flex","justify-content-center","spinner-container"],["color","green","mode","query","value","50","bufferValue","75"]],template:function(t,e){1&t&&(p.TgZ(0,"h5",0),p._uU(1,"Edit Role"),p.qZA(),p.TgZ(2,"mat-dialog-content",1),p.NdJ("ngSubmit",function(){return e.update()}),p.TgZ(3,"div",2),p.TgZ(4,"div",3),p.TgZ(5,"mat-form-field",4),p.TgZ(6,"mat-label"),p._uU(7,"Name"),p.qZA(),p._UZ(8,"input",5),p.YNc(9,E,2,1,"mat-error",6),p.qZA(),p.qZA(),p.qZA(),p.TgZ(10,"div",2),p.TgZ(11,"div",3),p.TgZ(12,"mat-form-field",4),p.TgZ(13,"mat-label"),p._uU(14,"Display Name"),p.qZA(),p._UZ(15,"input",7),p.YNc(16,Y,2,1,"mat-error",6),p.qZA(),p.qZA(),p.qZA(),p.TgZ(17,"div",8),p.YNc(18,I,2,1,"mat-error",6),p.YNc(19,k,3,2,"div",9),p.qZA(),p.qZA(),p.YNc(20,D,2,0,"div",10),p.TgZ(21,"mat-dialog-actions",11),p.TgZ(22,"button",12),p.NdJ("click",function(){return e.deleting()}),p.TgZ(23,"mat-icon"),p._uU(24,"delete"),p.qZA(),p._uU(25,"Delete "),p.qZA(),p.TgZ(26,"button",13),p.NdJ("click",function(){return e.close()}),p._uU(27,"Cancel"),p.qZA(),p.TgZ(28,"button",14),p.NdJ("click",function(){return e.update()}),p._uU(29,"Save"),p.qZA(),p.qZA()),2&t&&(p.xp6(2),p.Q6J("formGroup",e.editForm),p.xp6(7),p.Q6J("ngIf",null==e.formErrors?null:e.formErrors.name),p.xp6(7),p.Q6J("ngIf",null==e.formErrors?null:e.formErrors.display_name),p.xp6(2),p.Q6J("ngIf",null==e.formErrors?null:e.formErrors.permissions),p.xp6(1),p.Q6J("ngForOf",e.items.controls),p.xp6(1),p.Q6J("ngIf",e.loader),p.xp6(2),p.Q6J("disabled",e.loader),p.xp6(4),p.Q6J("disabled",e.loader)("mat-dialog-close",!0),p.xp6(2),p.Q6J("disabled",!e.editForm.valid||e.loader))},directives:[a.uh,a.xY,g.JL,g.sg,v.KE,v.hX,x.Nt,g.Fj,g.JJ,g.u,A.O5,g.CE,A.sg,a.H8,q.lW,U.Hw,a.ZT,v.TO,J.oG,_.pW],encapsulation:2}),t})();class O{constructor(t,e,i){this.value=t,this.label=e,this.checked=i||!1}}var Q=i(6874),R=i(32789),F=i(11436);const P=["search"];function H(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"button",31),p.NdJ("click",function(){return p.CHM(t),p.oxw().clearSearch()}),p.TgZ(1,"mat-icon"),p._uU(2,"close"),p.qZA(),p.qZA()}}function G(t,e){1&t&&(p.TgZ(0,"mat-header-cell",32),p._uU(1," Name "),p.qZA())}function W(t,e){if(1&t&&(p.TgZ(0,"mat-cell"),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.xp6(1),p.hij(" ",t.name," ")}}function B(t,e){1&t&&(p.TgZ(0,"mat-header-cell",32),p._uU(1," Display Name "),p.qZA())}function M(t,e){if(1&t&&(p.TgZ(0,"mat-cell"),p._uU(1),p.qZA()),2&t){const t=e.$implicit;p.xp6(1),p.hij(" ",t.display_name," ")}}function X(t,e){1&t&&(p.TgZ(0,"mat-header-cell"),p._uU(1," Permissions "),p.qZA())}function z(t,e){if(1&t&&(p.TgZ(0,"mat-cell"),p._uU(1),p.qZA()),2&t){const t=e.$implicit,i=p.oxw();p.xp6(1),p.AsE(" ",null==t.permissions?null:t.permissions.length," / ",null==i.allPermissions?null:i.allPermissions.length,"")}}function $(t,e){1&t&&(p.TgZ(0,"mat-header-cell"),p._uU(1," Actions "),p.qZA())}function L(t,e){if(1&t){const t=p.EpF();p.TgZ(0,"mat-cell",33),p.TgZ(1,"button",34,35),p.NdJ("click",function(){const e=p.CHM(t).$implicit;return p.oxw().editDialog(e)}),p.TgZ(3,"mat-icon",36),p._uU(4,"edit"),p.qZA(),p._uU(5," Edit / Assign Permissions "),p.qZA(),p.qZA()}2&t&&(p.xp6(1),p.Q6J("matTooltipPosition","above"))}function V(t,e){1&t&&p._UZ(0,"mat-header-row")}function K(t,e){1&t&&p._UZ(0,"mat-row")}function tt(t,e){1&t&&(p.TgZ(0,"span"),p._uU(1,"No Data"),p.qZA())}function et(t,e){1&t&&(p.TgZ(0,"div",37),p._UZ(1,"mat-progress-bar",38),p.qZA())}const it=o.Bz.forChild([{path:"",component:(()=>{class t{constructor(t,e,i,o){this.roleService=t,this.permissionService=e,this.notification=i,this.dialog=o,this.displayedColumns=["name","display_name","permissions","actions"],this.loader=!1,this.pageIndex=0,this.pageSizeOptions=[5,10,25,50,100],this.allPermissionsOptions=new Array}ngOnInit(){this.dataSource=new f(this.roleService),this.dataSource.meta$.subscribe(t=>this.meta=t),this.dataSource.load("",0,0,"updated_at","desc"),this.permissionService.list(["name","display_name"]).subscribe(t=>{this.allPermissions=t,this.allPermissionsOptions=this.allPermissions.map(t=>new O(t.id,t.display_name))},()=>this.allPermissions=[])}addDialog(){const t=new a.vA;t.disableClose=!0,t.autoFocus=!0,t.width="550px",t.height="450px",this.dialog.open(S,t).afterClosed().subscribe(t=>{t&&this.loadData()})}editDialog(t){const e=new a.vA;e.disableClose=!0,e.autoFocus=!0,e.data={role:t,permOptions:this.allPermissionsOptions},e.width="550px",e.height="450px",this.dialog.open(j,e).afterClosed().subscribe(e=>{e&&("deleting"===e?this.openConfirmationDialog(t):this.loadData())})}loadData(){this.dataSource.load(this.search.nativeElement.value,this.paginator.pageIndex+1,this.paginator.pageSize,this.sort.active,this.sort.direction)}ngAfterViewInit(){(0,l.R)(this.search.nativeElement,"keyup").pipe((0,m.b)(1e3),(0,u.x)(),(0,d.b)(()=>{this.paginator.pageIndex=0,this.loadData()})).subscribe(),this.paginator.page.pipe((0,d.b)(()=>this.loadData())).subscribe(),this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),(0,c.T)(this.sort.sortChange,this.paginator.page).pipe((0,d.b)(()=>this.loadData())).subscribe()}openConfirmationDialog(t){this.dialogRef=this.dialog.open(n.z,{disableClose:!0}),this.dialogRef.afterClosed().subscribe(e=>{e&&this.delete(t),this.dialogRef=null})}delete(t){this.loader=!0,this.roleService.delete(t).subscribe(t=>{this.loader=!1,this.loadData(),this.notification.showNotification("success","Success !! Role has been deleted.")},t=>{this.loader=!1,this.notification.showNotification("danger",t.error.message?t.error.message:"Delete Error !! ")})}clearSearch(){this.search.nativeElement.value="",this.loadData()}}return t.\u0275fac=function(e){return new(e||t)(p.Y36(Z.k),p.Y36(Q._),p.Y36(b.g),p.Y36(a.uw))},t.\u0275cmp=p.Xpm({type:t,selectors:[["robi-user-role-setting"]],viewQuery:function(t,e){if(1&t&&(p.Gf(P,7),p.Gf(s.NW,7),p.Gf(r.YE,7)),2&t){let t;p.iGM(t=p.CRH())&&(e.search=t.first),p.iGM(t=p.CRH())&&(e.paginator=t.first),p.iGM(t=p.CRH())&&(e.sort=t.first)}},decls:41,vars:12,consts:[[1,"row"],[1,"fab-container"],["mat-fab","",1,"fab-toggler",3,"click"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"row","search-form-section"],[1,"col-3"],["mat-button","","matPrefix","","mat-stroked-button","","aria-label","add new",3,"click"],[1,"col-9"],[1,"search-form-field"],["matInput","","placeholder","Search","autocomplete","off",3,"disabled"],["search",""],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[1,"table-responsive"],["matSort","","matSortActive","name","matSortDirection","asc","matSortDisableClear","",3,"dataSource"],["table",""],["matColumnDef","name"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","display_name"],["matColumnDef","permissions"],[4,"matHeaderCellDef"],["matColumnDef","actions"],["class","button-row",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[4,"ngIf"],["class","d-flex justify-content-center spinner-container",4,"ngIf"],["showFirstLastButtons","",3,"length","pageIndex","pageSizeOptions"],["pagination",""],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["mat-sort-header",""],[1,"button-row"],["mat-icon-button","","matTooltip","Edit / Assign Permissions",3,"matTooltipPosition","click"],["editButton",""],["color","accent"],[1,"d-flex","justify-content-center","spinner-container"],["color","green","mode","query","value","50","bufferValue","75"]],template:function(t,e){if(1&t&&(p.TgZ(0,"div",0),p.TgZ(1,"div",1),p.TgZ(2,"button",2),p.NdJ("click",function(){return e.addDialog()}),p.TgZ(3,"mat-icon"),p._uU(4,"add"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(5,"div",3),p.TgZ(6,"div",4),p.TgZ(7,"div",5),p.TgZ(8,"div",6),p.TgZ(9,"div",7),p.TgZ(10,"button",8),p.NdJ("click",function(){return e.addDialog()}),p.TgZ(11,"mat-icon"),p._uU(12,"add"),p.qZA(),p._uU(13," New Role "),p.qZA(),p.qZA(),p.TgZ(14,"div",9),p.TgZ(15,"mat-form-field",10),p._UZ(16,"input",11,12),p.YNc(18,H,3,0,"button",13),p.qZA(),p.qZA(),p.qZA(),p.TgZ(19,"div",14),p.TgZ(20,"mat-table",15,16),p.ynx(22,17),p.YNc(23,G,2,0,"mat-header-cell",18),p.YNc(24,W,2,1,"mat-cell",19),p.BQk(),p.ynx(25,20),p.YNc(26,B,2,0,"mat-header-cell",18),p.YNc(27,M,2,1,"mat-cell",19),p.BQk(),p.ynx(28,21),p.YNc(29,X,2,0,"mat-header-cell",22),p.YNc(30,z,2,2,"mat-cell",19),p.BQk(),p.ynx(31,23),p.YNc(32,$,2,0,"mat-header-cell",22),p.YNc(33,L,6,1,"mat-cell",24),p.BQk(),p.YNc(34,V,1,0,"mat-header-row",25),p.YNc(35,K,1,0,"mat-row",26),p.qZA(),p.YNc(36,tt,2,0,"span",27),p.YNc(37,et,2,0,"div",28),p.ALo(38,"async"),p._UZ(39,"mat-paginator",29,30),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&t){const t=p.MAs(17);p.xp6(16),p.Q6J("disabled",0===(null==e.meta?null:e.meta.total)),p.xp6(2),p.Q6J("ngIf",t.value),p.xp6(2),p.Q6J("dataSource",e.dataSource),p.xp6(14),p.Q6J("matHeaderRowDef",e.displayedColumns),p.xp6(1),p.Q6J("matRowDefColumns",e.displayedColumns),p.xp6(1),p.Q6J("ngIf",0===(null==e.meta?null:e.meta.total)),p.xp6(1),p.Q6J("ngIf",p.lcZ(38,10,null==e.dataSource?null:e.dataSource.loading$)||e.loader),p.xp6(2),p.Q6J("length",null==e.meta?null:e.meta.total)("pageIndex",e.pageIndex)("pageSizeOptions",e.pageSizeOptions)}},directives:[q.lW,U.Hw,v.qo,v.KE,x.Nt,A.O5,R.BZ,r.YE,R.w1,R.fO,R.Dz,R.as,R.nj,s.NW,v.R9,R.ge,r.nU,R.ev,F.gM,R.XQ,R.Gk,_.pW],pipes:[A.Ov],styles:[""]}),t})()}]);var ot=i(83893);let at=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=p.oAB({type:t}),t.\u0275inj=p.cJS({imports:[[ot.m,it]]}),t})()},1581:function(t,e,i){i.d(e,{y:function(){return n}});var o=i(26215),a=i(25917),s=i(5304),r=i(68939);class n{constructor(t){this.service=t,this.dataSubject=new o.X([]),this.loadingSubject=new o.X(!1),this.loading$=this.loadingSubject.asObservable(),this.metaSubject=new o.X({}),this.meta$=this.metaSubject.asObservable()}load(t,e,i,o="",n="",l="",c=""){this.loadingSubject.next(!0),this.service.getAll(t,e,i,o,n,l,c).pipe((0,s.K)(()=>(0,a.of)([])),(0,r.x)(()=>this.loadingSubject.next(!1))).subscribe(t=>{this.dataSubject.next(t.data),this.metaSubject.next(t.meta)})}loadNested(t,e,i,o,n="",l="",c="",m=""){this.loadingSubject.next(!0),this.service.getNested(t,e,i,o,n,l,c,m).pipe((0,s.K)(()=>(0,a.of)([])),(0,r.x)(()=>this.loadingSubject.next(!1))).subscribe(t=>{this.dataSubject.next(t.data),this.metaSubject.next(t.meta)})}connect(t){return this.dataSubject.asObservable()}disconnect(t){this.dataSubject.complete(),this.loadingSubject.complete()}}}}]);
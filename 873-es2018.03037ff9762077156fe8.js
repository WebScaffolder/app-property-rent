"use strict";(self.webpackChunkmaterial_dashboard_angular=self.webpackChunkmaterial_dashboard_angular||[]).push([[873],{18873:function(t,e,o){o.r(e),o.d(e,{GeneralSettingModule:function(){return k}});var a=o(39895),i=o(3679),n=o(25917),s=o(86710),r=o(1015),l=o(8606),m=o(40005),c=o(2603),d=o(4919),g=o(37716),u=o(14469),h=o(57404),p=o(38583),Z=o(98295),f=o(49983),T=o(67441),A=o(51095),_=o(72458),v=o(12178),b=o(29790);function q(t,e){if(1&t&&(g.TgZ(0,"mat-option",37),g._uU(1),g.ALo(2,"translate"),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.value),g.xp6(1),g.hij(" ",g.lcZ(2,2,"robi.settings.themes."+t.label)," ")}}function U(t,e){if(1&t&&(g.TgZ(0,"figure",38),g._UZ(1,"img",39),g.ALo(2,"async"),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("src",g.lcZ(2,1,t.showPhoto),g.LSH)}}function y(t,e){if(1&t&&(g.TgZ(0,"mat-option",37),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.name),g.xp6(1),g.hij(" ",t.display_name," ")}}function E(t,e){if(1&t&&(g.TgZ(0,"mat-option",37),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.name),g.xp6(1),g.hij(" ",t.display_name," ")}}function N(t,e){if(1&t&&(g.TgZ(0,"mat-option",37),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.name),g.xp6(1),g.hij(" ",t.display_name," ")}}function S(t,e){if(1&t&&(g.TgZ(0,"mat-option",37),g._uU(1),g.qZA()),2&t){const t=e.$implicit;g.Q6J("value",t.name),g.xp6(1),g.hij(" ",t.display_name," ")}}function x(t,e){1&t&&(g.TgZ(0,"div",40),g._UZ(1,"mat-progress-bar",41),g.qZA())}function C(t,e){if(1&t){const t=g.EpF();g.ynx(0),g.TgZ(1,"form",7),g.NdJ("ngSubmit",function(){return g.CHM(t),g.oxw().onSubmit()}),g.TgZ(2,"div",0),g.TgZ(3,"div",8),g.TgZ(4,"div",0),g.TgZ(5,"div",1),g.TgZ(6,"mat-form-field",9),g.TgZ(7,"mat-label"),g._uU(8,"Company Name"),g.qZA(),g._UZ(9,"input",10),g.qZA(),g.qZA(),g.qZA(),g.TgZ(10,"div",0),g.TgZ(11,"div",11),g.TgZ(12,"mat-form-field",9),g.TgZ(13,"mat-label"),g._uU(14,"Contact Email"),g.qZA(),g._UZ(15,"input",12),g.qZA(),g.qZA(),g.TgZ(16,"div",11),g.TgZ(17,"mat-form-field",9),g.TgZ(18,"mat-label"),g._uU(19,"Phone"),g.qZA(),g._UZ(20,"input",13),g.qZA(),g.qZA(),g.qZA(),g.TgZ(21,"div",0),g.TgZ(22,"div",1),g.TgZ(23,"mat-form-field",9),g.TgZ(24,"mat-label"),g._uU(25,"Default Currency"),g.qZA(),g._UZ(26,"input",14),g.qZA(),g.qZA(),g.qZA(),g.TgZ(27,"div",0),g.TgZ(28,"div",1),g.TgZ(29,"mat-form-field",9),g.TgZ(30,"mat-label"),g._uU(31),g.ALo(32,"translate"),g.qZA(),g.TgZ(33,"mat-select",15),g.NdJ("selectionChange",function(e){return g.CHM(t),g.oxw().onThemeSelect(e)}),g.YNc(34,q,3,4,"mat-option",16),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(35,"div",17),g.TgZ(36,"div",18),g.YNc(37,U,3,3,"figure",19),g.TgZ(38,"div"),g.TgZ(39,"input",20,21),g.NdJ("change",function(e){return g.CHM(t),g.oxw().onProfilePhotoSelect(e.target.files)}),g.qZA(),g.TgZ(41,"button",22),g.NdJ("click",function(){return g.CHM(t),g.MAs(40).click()}),g.TgZ(42,"i",23),g._uU(43,"attachment"),g.qZA(),g._uU(44," Logo"),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(45,"div",0),g.TgZ(46,"div",1),g.TgZ(47,"mat-form-field",9),g.TgZ(48,"mat-label"),g._uU(49,"Physical Address"),g.qZA(),g._UZ(50,"input",24),g.qZA(),g.qZA(),g.qZA(),g.TgZ(51,"div",0),g.TgZ(52,"div",1),g.TgZ(53,"mat-form-field",9),g.TgZ(54,"mat-label"),g._uU(55,"Postal Address"),g.qZA(),g._UZ(56,"input",25),g.qZA(),g.qZA(),g.qZA(),g.TgZ(57,"div",0),g.TgZ(58,"div",1),g.TgZ(59,"mat-form-field",9),g.TgZ(60,"mat-label"),g._uU(61,"Website Url"),g.qZA(),g._UZ(62,"input",26),g.qZA(),g.qZA(),g.qZA(),g.TgZ(63,"div",0),g.TgZ(64,"div",11),g.TgZ(65,"mat-form-field",9),g.TgZ(66,"mat-label"),g._uU(67,"ZIP / Postal Code"),g.qZA(),g._UZ(68,"input",27),g.qZA(),g.qZA(),g.TgZ(69,"div",11),g.TgZ(70,"mat-form-field",9),g.TgZ(71,"mat-label"),g._uU(72,"Date Format"),g.qZA(),g.TgZ(73,"mat-select",28),g.YNc(74,y,2,2,"mat-option",16),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g.TgZ(75,"div",0),g.TgZ(76,"div",29),g.TgZ(77,"mat-form-field",9),g.TgZ(78,"mat-label"),g._uU(79,"Amount Thousand Separator"),g.qZA(),g.TgZ(80,"mat-select",30),g.YNc(81,E,2,2,"mat-option",16),g.qZA(),g.qZA(),g.qZA(),g.TgZ(82,"div",29),g.TgZ(83,"mat-form-field",9),g.TgZ(84,"mat-label"),g._uU(85,"Amount Decimal Separator"),g.qZA(),g.TgZ(86,"mat-select",31),g.YNc(87,N,2,2,"mat-option",16),g.qZA(),g.qZA(),g.qZA(),g.TgZ(88,"div",29),g.TgZ(89,"mat-form-field",9),g.TgZ(90,"mat-label"),g._uU(91,"Amount Decimals"),g.qZA(),g.TgZ(92,"mat-select",32),g.YNc(93,S,2,2,"mat-option",16),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g._UZ(94,"div",33),g.YNc(95,x,2,0,"div",34),g.TgZ(96,"div"),g.TgZ(97,"button",35),g.NdJ("click",function(){return g.CHM(t),g.oxw().update()}),g._uU(98,"Update Settings"),g.qZA(),g.qZA(),g._UZ(99,"div",36),g.qZA(),g.BQk()}if(2&t){const t=e.ngIf,o=g.oxw();g.xp6(1),g.Q6J("formGroup",o.form),g.xp6(30),g.Oqu(g.lcZ(32,11,"robi.settings.themes.placeholder")),g.xp6(2),g.Q6J("ngModel",t.theme),g.xp6(1),g.Q6J("ngForOf",o.themes),g.xp6(3),g.Q6J("ngIf",o.showPhoto),g.xp6(37),g.Q6J("ngForOf",o.dateFormats),g.xp6(7),g.Q6J("ngForOf",o.amountThousandSeparators),g.xp6(6),g.Q6J("ngForOf",o.amountDecimalSeparators),g.xp6(6),g.Q6J("ngForOf",o.amountDecimals),g.xp6(2),g.Q6J("ngIf",o.loader),g.xp6(2),g.Q6J("disabled",!o.form.valid||o.loader)}}const I=a.Bz.forChild([{path:"",component:(()=>{class t{constructor(t,e,o,a,n){this.store=t,this.fb=e,this.route=o,this.generalSettingService=a,this.notification=n,this.loader=!1,this.logoToUpload=null,this.logoUrl="",this.photoToUpload=null,this.photoUrl="",this.routeAnimationsElements=r.rd,this.themes=[{value:"DEFAULT-THEME",label:"blue"},{value:"LIGHT-THEME",label:"light"},{value:"NATURE-THEME",label:"nature"},{value:"BLACK-THEME",label:"dark"},{value:"ORANGE-THEME",label:"orange"},{value:"RED-THEME",label:"red"},{value:"PURPLE-THEME",label:"purple"},{value:"GREEN-THEME",label:"green"},{value:"BROWN-THEME",label:"brown"},{value:"GREY-THEME",label:"grey"},{value:"PINK-THEME",label:"pink"}],this.languages=[{value:"en",label:"en"},{value:"de",label:"de"},{value:"sk",label:"sk"},{value:"fr",label:"fr"},{value:"es",label:"es"},{value:"pt-br",label:"pt-br"},{value:"zh-cn",label:"zh-cn"},{value:"he",label:"he"}],this.form=this.fb.group({theme:[""],language:[""],company_name:["",[i.kI.required,i.kI.minLength(3)]],email:["",[i.kI.required,i.kI.minLength(3)]],currency:[""],phone:[""],physical_address:[""],postal_address:[""],website_url:[""],postal_code:[""],date_format:[""],amount_thousand_separator:[""],amount_decimal_separator:[""],amount_decimal:[""]})}ngOnInit(){this.settings$=this.store.pipe((0,s.Ys)(l.vi)),this.route.snapshot.data.setting&&(this.setting=this.route.snapshot.data.setting,this.prePopulateForm(this.setting),this.settingId=this.setting.id,this.getImageFromService(),this.dateFormats=this.setting.date_formats,this.amountThousandSeparators=this.setting.amount_thousand_separators,this.amountDecimalSeparators=this.setting.amount_decimal_separators,this.amountDecimals=this.setting.amount_decimals)}onLanguageSelect({value:t}){this.store.dispatch((0,m.tH)({language:t}))}onThemeSelect({value:t}){this.store.dispatch((0,m.qA)({theme:t}))}onAutoNightModeToggle({checked:t}){this.store.dispatch((0,m.E3)({autoNightMode:t}))}onStickyHeaderToggle({checked:t}){this.store.dispatch((0,m.ZV)({stickyHeader:t}))}onPageAnimationsToggle({checked:t}){this.store.dispatch((0,m.oI)({pageAnimations:t}))}onElementsAnimationsToggle({checked:t}){this.store.dispatch((0,m.TO)({elementsAnimations:t}))}prePopulateForm(t){this.setting=t,this.form.patchValue({theme:"",language:"",company_name:this.setting.company_name,email:this.setting.email,currency:this.setting.currency,phone:this.setting.phone,country:this.setting.country,county:this.setting.county,town:this.setting.town,physical_address:this.setting.physical_address,postal_address:this.setting.postal_address,postal_code:this.setting.postal_code,website_url:this.setting.website_url,logo:this.setting.logo,date_format:this.setting.date_format,amount_thousand_separator:this.setting.amount_thousand_separator,amount_decimal_separator:this.setting.amount_decimal_separator,amount_decimal:this.setting.amount_decimal})}onSubmit(){}onLogoSelect(t){if(t.length>0){this.logoToUpload=t.item(0);const e=new FileReader;e.onload=t=>{this.logoUrl=t.target.result},e.readAsDataURL(this.logoToUpload)}}onProfilePhotoSelect(t){if(t.length>0){this.photoToUpload=t.item(0),this.photoName=t.item(0).name;const e=new FileReader;e.onload=t=>{this.photoUrl=t.target.result},e.readAsDataURL(this.photoToUpload),this.loader=!0;const o=new FormData;o.append("logo",this.photoToUpload),o.append("id",this.settingId),this.uploadPhoto(o)}}getImageFromService(){this.setting&&null!==this.setting.logo&&this.generalSettingService.fetchPhoto(this.settingId).subscribe(t=>{this.createImageFromBlob(t)},t=>{})}createImageFromBlob(t){const e=new FileReader;e.addEventListener("load",()=>{this.showPhoto=(0,n.of)(e.result)},!1),t&&e.readAsDataURL(t)}uploadPhoto(t){this.generalSettingService.updatePhoto(t).subscribe(t=>{this.loader=!1,this.getImageFromService(),this.notification.showNotification("success","Success !! Logo has been updated.")},t=>{if(this.loader=!1,0!==t.payment&&(this.formErrors=t,this.formErrors))for(const e in this.formErrors)this.form&&this.form.controls[e].setErrors({incorrect:!0})})}update(){const t=Object.assign({},this.setting,this.form.value);this.store.pipe((0,s.Ys)(d.XG)).subscribe(e=>{const o={...e};o.g_settings=t,this.authenticatedUser=o}),this.store.dispatch(c.u.actionLogin({user:this.authenticatedUser}));const e=new FormData;e.append("logo",this.logoToUpload),e.append("id",t.id),this.loader=!0,this.generalSettingService.update(t).subscribe(t=>{this.loader=!1,this.notification.showNotification("success","Success !! Setting has been updated.")},t=>{if(this.loader=!1,0!==t.payment&&(this.formErrors=t,this.formErrors))for(const e in this.formErrors)this.form&&this.form.controls[e].setErrors({incorrect:!0})})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(s.yh),g.Y36(i.qu),g.Y36(a.gz),g.Y36(u.E),g.Y36(h.g))},t.\u0275cmp=g.Xpm({type:t,selectors:[["robi-general-setting"]],decls:10,vars:6,consts:[[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-header","card-header-info"],[1,"card-category"],[1,"card-body"],[4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"col-md-7"],["color","primary","appearance","outline",1,"full-width"],["matInput","","placeholder","Company Name","formControlName","company_name"],[1,"col-md-6"],["matInput","","placeholder","Contact Email","formControlName","email"],["matInput","","placeholder","Phone","formControlName","phone"],["matInput","","placeholder","Currency","formControlName","currency"],["formControlName","theme",3,"ngModel","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-5"],[1,"logo","centerTop"],["class","item simple-text",4,"ngIf"],["type","file","accept","image/*",1,"file-input",3,"change"],["logoFileInput",""],["mat-button","",1,"mat-raised-button",3,"click"],[1,"material-icons"],["matInput","","placeholder","Physical Address","formControlName","physical_address"],["matInput","","placeholder","Postal Address","formControlName","postal_address"],["matInput","","placeholder","Website Url","formControlName","website_url"],["matInput","","placeholder","ZIP / Postal Code","formControlName","postal_code"],["placeholder","Date Format","formControlName","date_format"],[1,"col-md-4"],["placeholder","Amount Thousand Separator","formControlName","amount_thousand_separator"],["placeholder","Amount Decimal Separator","formControlName","amount_decimal_separator"],["placeholder","Amount Decimals","formControlName","amount_decimal"],[1,"divider","divider-md"],["class","d-flex justify-content-center spinner-container",4,"ngIf"],["mat-raised-button","","type","submit","color","accent",1,"btn","pull-right",3,"disabled","click"],[1,"clearfix"],[3,"value"],[1,"item","simple-text"],["alt","Logo",1,"img",3,"src"],[1,"d-flex","justify-content-center","spinner-container"],["color","green","mode","query","value","50","bufferValue","75"]],template:function(t,e){1&t&&(g.TgZ(0,"div",0),g.TgZ(1,"div",1),g.TgZ(2,"div",2),g.TgZ(3,"div",3),g.TgZ(4,"p",4),g._uU(5),g.ALo(6,"translate"),g.qZA(),g.qZA(),g.TgZ(7,"div",5),g.YNc(8,C,100,13,"ng-container",6),g.ALo(9,"async"),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&t&&(g.xp6(5),g.hij(" ",g.lcZ(6,2,"robi.settings.general.title"),""),g.xp6(3),g.Q6J("ngIf",g.lcZ(9,4,e.settings$)))},directives:[p.O5,i._Y,i.JL,i.sg,Z.KE,Z.hX,f.Nt,i.Fj,i.JJ,i.u,T.gD,p.sg,A.lW,_.ey,v.pW],pipes:[b.X$,p.Ov],styles:["figure.item[_ngcontent-%COMP%]{vertical-align:top;display:inline-block;text-align:center}img[_ngcontent-%COMP%]{width:150px;height:150px;background-color:gray}.caption[_ngcontent-%COMP%]{display:block}.centerTop[_ngcontent-%COMP%]{text-align:center;padding-top:25px}"]}),t})()}]);var w=o(83893);o(39075);let P=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[p.ez]]}),t})(),k=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[w.m,I,P]]}),t})()}}]);